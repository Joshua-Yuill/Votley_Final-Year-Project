<!DOCTYPE html>
 
<html lang="en">
<script src="/chart.js@v2"></script>

<style>
/* https://www.w3schools.com/css/css_font.asp */
body
{
    font-family: 'Helvetica', 'Arial', sans-serif;
    color: #444444;
    font-size: 40pt;
    background-color: #FAFAFA;
    text-align: center;
}
.column {
  float: left;
  width: 50%;
}

.row:after {
  content: "";
  display: table;
  clear: both;
}

.now{
    font-family: 'Helvetica', 'Arial', sans-serif;
    color: #01A982;
    font-size: 20pt;
    background-color: #FAFAFA;
    text-align: center;
}
</style>
    <meta charset="UTF-8">
 
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
 
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
 
    <title>Powerpoint Websocket Client</title>
 
</head>
 
<!-- https://www.w3schools.com/howto/howto_css_two_columns.asp -->
<body>
<div class="row">
<div class="column">
    <p><b>Did William the Conqueror Win the Battle of hastings in 1066?</b></p>
    <br>
    <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=Example">
    <div class="now">Cast your vote now!</div>
</div>
<div class="column">
    <canvas id="myChart"width="5" height="5"></canvas>
</div>
</div>
</body>
 
<script>
  // https://www.chartjs.org/docs/latest/charts/bar.html
  const ctx = document.getElementById('myChart');



  const data = {
    labels: ['He Won The war','He died in battle','He lost the war'],
    datasets: [{
      label: 'No Of Votes',
      data: [0,0,0],
      // Define the chart colors
      backgroundColor: [
        'rgba(255, 26, 104, 0.2)',
        'rgba(54, 162, 235, 0.2)',
        'rgba(255, 206, 86, 0.2)',
        'rgba(75, 192, 192, 0.2)',
        'rgba(153, 102, 255, 0.2)',
        'rgba(255, 159, 64, 0.2)',
        'rgba(0, 0, 0, 0.2)'
      ],
      borderColor: [
        'rgba(255, 26, 104, 1)',
        'rgba(54, 162, 235, 1)',
        'rgba(255, 206, 86, 1)',
        'rgba(75, 192, 192, 1)',
        'rgba(153, 102, 255, 1)',
        'rgba(255, 159, 64, 1)',
        'rgba(0, 0, 0, 1)'
      ],
      borderWidth: 1
    }]
  };


  // Configuring the chart
  const config = {
    type: 'bar',
    data,
    options: {
        scales: {
            yAxes: [{
                ticks: {
                    beginAtZero: true
                }
            }]
        }
    }
  };

  // render init block
  const myChart = new Chart(
    document.getElementById('myChart'),
    config
  );
  // https://www.chartjs.org/docs/latest/developers/updates.html
  function addData(chart, label, data) {
    chart.data.labels.push(label);
    chart.data.datasets.forEach((dataset) => {
        dataset.data.push(data);
    });
    Chart.update();
}
 

  // https://developer.mozilla.org/en-US/docs/Web/API/WebSocket
  // Open a WebSocket connection
  const socket = new WebSocket('wss://connection.kimochi.uk/wss');
 
    socket.addEventListener('open', function (event) {
 
    socket.send('hello');
 
  });
 
 
  // Listen for messages
  socket.addEventListener('message', function (event) {
 
    //document.write(event.data);
    
    var obj = event.data;
    
    console.log(typeof event.data);
    
    let start = "'";
    var val = parseInt(obj[5])
    
    var datas = JSON.parse(event.data);
    console.log(datas);
    console.log(datas[0]);
    
    // Update the chart with the new data received from websocket
    myChart.data.datasets[0].data[0] = datas[0];
    myChart.data.datasets[0].data[1] = datas[1];
    myChart.data.datasets[0].data[2] = datas[2];
    myChart.update();
    
 
  });
  
  // Send a message to the WebSocket server
  const contactServer = () => {
 
    socket.send("Hello");
 
  }
 
</script>
<!--Chart.js for visulaisations in powerpoint-->
 
</html>